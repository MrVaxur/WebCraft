<!DOCTYPE HTML>
<html>
	<head>
		<title>WebCraft</title>
		
		<!-- Kodowanie -->
		<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
		
		<!-- Style -->
		<link href="style/main.css" rel="stylesheet" type="text/css">
		
		<!-- Moduly -->
		<script src="js/glMatrix-1.2.min.js" type="text/javascript"></script> 
		<script src="js/blocks.js" type="text/javascript"></script>
		<script src="js/helpers.js" type="text/javascript"></script>
		<script src="js/generator.js" type="text/javascript"></script>
		<script src="js/world.js" type="text/javascript"></script>
		<script src="js/render.js" type="text/javascript"></script>
		<script src="js/physics.js" type="text/javascript"></script>
		<script src="js/player.js" type="text/javascript"></script>
		<script src="js/fps.js" type="text/javascript"></script>
	</head>
	
	<body oncontextmenu="return false">
		<!-- Render surface -->
		<canvas id="renderSurface"></canvas>
	
		<div id="blocks" style="display: none;">
			<center>Wybor klocka:</center></br>
			<img class="block" src="media/items/stone.png" alt="Zmien klocek" onclick="player.buildMaterial = BLOCK.CONCRETE;">
			<img class="block" src="media/items/dirt.png" alt="Zmien klocek" onclick="player.buildMaterial = BLOCK.DIRT;">
			<img class="block" src="media/items/grass.png" alt="Zmien klocek" onclick="player.buildMaterial = BLOCK.GRASS;">
			<img class="block" src="media/items/bedrock.png" alt="Zmien klocek" onclick="player.buildMaterial = BLOCK.BEDROCK;">
			<img class="block" src="media/items/cobblestone.png" alt="Zmien klocek" onclick="player.buildMaterial = BLOCK.COBBLESTONE;">
			<img class="block" src="media/items/sand.png" alt="Zmien klocek" onclick="player.buildMaterial = BLOCK.SAND;">
			<img class="block" src="media/items/goldblock.png" alt="Zmien klocek" onclick="player.buildMaterial = BLOCK.GOLD;">
			<img class="block" src="media/items/goldore.png" alt="Zmien klocek" onclick="player.buildMaterial = BLOCK.GOLD_ORE;">
			<img class="block" src="media/items/diamondblock.png" alt="Zmien klocek" onclick="player.buildMaterial = BLOCK.DIAMOND;">
			<img class="block" src="media/items/diamondore.png" alt="Zmien klocek" onclick="player.buildMaterial = BLOCK.DIAMOND_ORE;">
			<br><center>Aby zamknac wcisnij <b>Esc</b></center>
		</div>
        
		<!-- Infobox -->
		<div id="infobox">
			<span id="infobox_text">WebCraft v0.2.1 Desktop</br>
			<div id="fps"></div></br>
			Wybor klocka pod E</span>
		</div>
		
		<!-- Initialisation code -->
		<script type="text/javascript">			
			// Tworzenie mapy
			var world = new World( 60,60, 100, 80, 2, 0.1 );
			world.createWorld();
			
			// Render
			var render = new Renderer( "renderSurface" );
			render.setWorld( world, 8 );
			render.setPerspective( 80, 0.01, 220 );
			
			// Fizyka
			//var physics = new Physics();
			//physics.setWorld( world );
			
			// Stworzenie playera
			var player = new Player();
			player.setWorld( world );
			player.setInputCanvas( "renderSurface", 1 );
			//player.setMaterialSelector( "materialSelector" );
			
			// Render		
			setInterval( function()
			{
				var time = new Date().getTime() / 1000.0;
				
				// Simulate physics
				//physics.simulate();
				
				// Update local player
				player.update();
				
				// Build a chunk
				render.buildChunks( 30 );
				
				// Draw world
				render.setCamera( player.getEyePos().toArray(), player.angles );
				render.draw();
				
				while ( new Date().getTime() / 1000 - time < 0.016 );
			}, 1 );
		</script>
	</body>
</html>
